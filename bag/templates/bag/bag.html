{% extends "base.html" %}
{% load bag_tools %}

{% block title %}Your Bag | Le Frat{% endblock %}

{% block content %}
<h1>Your Bag</h1>

{% if bag %}
  <ul>
    {% for item_id, quantity in bag.items %}
      {% with product=products|get_item:item_id %}
      <li>
        <strong>{{ product.name }}</strong> â€“ ${{ product.price }}

        <form method="POST" action="{% url 'update_bag' product.id %}">
          {% csrf_token %}
          <input type="number" name="quantity" value="{{ quantity }}" min="1" max="{{ product.stock }}">
          <button type="submit">Update</button>
        </form>

        <form method="POST" action="{% url 'remove_from_bag' product.id %}">
          {% csrf_token %}
          <button type="submit">Remove</button>
        </form>
      </li>
      {% endwith %}
    {% endfor %}
  </ul>
{% else %}
  <p>Your bag is empty.</p>
{% endif %}

<a href="{% url 'products' %}">Continue shopping</a>
{% endblock %}
